(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{630:function(e,t,n){e.exports={}},653:function(e,t,n){e.exports=n.p+"img/banner.d8d0055.jpg"},654:function(e,t,n){e.exports=n.p+"img/logo-lighte.e95b1a9.png"},655:function(e,t,n){"use strict";n(630)},694:function(e,t,n){"use strict";n.r(t);var r=n(262),o=n(164),c=n(264),l=n(15),d=n(538),_=n(543),m=n(527),f=n(544),v=n(537),h=n(540),w=n(529),x=n(65),k=(n(9),n(8),n(11),n(3),n(13),n(10),n(14),n(1)),C=n(6);n(34),n(37);function $(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(t){Object(k.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var O={props:{is_signin_f:{default:!0}},data:function(){return{phone_dialog:!1,forget_dialog:!1,is_reset_password:!1,reset_password_date:null,reset_password_seconds:null,is_new_password:!1,is_signin:!0,is_loading:!1,show_password:!1,is_valid_signin:!1,is_valid_signup:!1,form:{},dialog:!1}},computed:{progress:function(){return Math.min(100,10*(this.form.password?this.form.password.length:0))},color:function(){return["error","warning","success"][Math.floor(this.progress/40)]}},watch:{forget_dialog:function(e){e||(this.is_reset_password=!1)},"$route.query.email":function(){this.$store.commit("user/logout"),this.form.email=this.$route.query.email,this.form.password=this.$route.query.password,this.signin()}},methods:{newPassword:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.is_loading=!0,t.next=3,e.$recaptcha.getToken();case 3:return n=t.sent,t.next=6,e.$api.post("auth/new-reset-password",y(y({},e.form),{recaptcha_token:n})).then((function(t){e.$router.push(e.localePath({name:"user"})),e.forget_dialog=!1,e.$toast.success("Votre mot de passe a été changé")})).catch((function(t){e.is_loading=!1}));case 6:e.is_loading=!1;case 7:case"end":return t.stop()}}),t)})))()},checkCode:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.is_loading=!0,t.next=3,e.$recaptcha.getToken();case 3:return n=t.sent,t.next=6,e.$api.post("auth/verification-reset-password",y(y({},e.form),{recaptcha_token:n})).then((function(t){e.is_new_password=!0,e.$store.commit("user/setInfo",t.data)})).catch((function(t){e.is_loading=!1}));case 6:e.is_loading=!1;case 7:case"end":return t.stop()}}),t)})))()},sendForgetCode:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.is_loading=!0,t.next=3,e.$recaptcha.getToken();case 3:return n=t.sent,t.next=6,e.$api.post("auth/send-reset-password",y(y({},e.form),{recaptcha_token:n})).then((function(t){t.data.result&&(e.reset_password_date=t.data.result.reset_password_date),e.is_reset_password=!0})).catch((function(t){e.is_loading=!1}));case 6:e.is_loading=!1;case 7:case"end":return t.stop()}}),t)})))()},signin:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.is_valid_signin){t.next=8;break}return e.is_loading=!0,t.next=4,e.$recaptcha.getToken();case 4:return n=t.sent,t.next=7,e.$api.post("auth/signin",y(y({},e.form),{recaptcha_token:n})).then((function(t){t.data.result.info.phone?e.$store.commit("user/setInfo",t.data):e.phone_dialog=!0})).catch((function(t){e.is_loading=!1}));case 7:e.is_loading=!1;case 8:case"end":return t.stop()}}),t)})))()},signup:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.is_valid_signup){t.next=8;break}return e.is_loading=!0,t.next=4,e.$recaptcha.getToken();case 4:return n=t.sent,t.next=7,e.$api.post("auth/signup",y(y({},e.form),{recaptcha_token:n})).then((function(t){e.$store.commit("user/setInfo",t.data)})).catch((function(e){}));case 7:e.is_loading=!1;case 8:setTimeout(Object(C.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),1500);case 9:case"end":return t.stop()}}),t)})))()},googleAuth:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$gAuth.signIn().then(function(){var t=Object(C.a)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.is_loading=!0,t.next=3,e.$recaptcha.getToken();case 3:return r=t.sent,t.next=6,e.$api.post("auth/signin",y({access_token:n.getAuthResponse().access_token,access_type:"google"},{recaptcha_token:r})).then((function(t){t.data.result.info.phone||(e.phone_dialog=!0),e.$store.commit("user/setInfo",t.data)})).catch((function(t){e.is_loading=!1}));case 6:e.is_loading=!1;case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},saveAccount:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$api.post("user/account",{phone:e.form.phone}).then((function(t){e.$router.push(e.localePath({name:"user"})),e.$store.dispatch("user/validation")}));case 3:e.loading=!1;case 4:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(C.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:setInterval((function(){e.reset_password_date&&e.reset_password_date>=e.$moment().unix()&&(e.reset_password_seconds=1e3*(e.reset_password_date-e.$moment().unix()))}),1e3),e.is_signin=e.is_signin_f,e.$route.query.email&&(e.$store.commit("user/logout"),e.form.email=e.$route.query.email,e.form.password=e.$route.query.password,e.signin()),e.$route.query.r&&e.$cookies.set("referral-code",e.$route.query.r,{path:"/",maxAge:604800}),e.$cookies.get("referral-code")&&(e.form.referral_code=e.$cookies.get("referral-code"));case 5:case"end":return t.stop()}}),t)})))()}},j=O,R=n(23),P={components:{Login:Object(R.a)(j,(function(){var e=this,t=e._self._c;return t("div",[t(r.a,{staticClass:"elevation-0 transparent",attrs:{loading:e.is_loading,disabled:e.is_loading}},[t(c.a,{staticClass:"mb-2 white shadow black--text",attrs:{block:"",large:""},on:{click:function(t){return e.googleAuth()}}},[t("img",{staticClass:"mr-1",attrs:{src:"https://cdn-icons-png.flaticon.com/128/270/270799.png",width:"30",alt:"Connectez-vous avec Google"}}),e._v(" "),t(h.a),e._v("\n      Connectez-vous avec Google\n    ")],1),e._v(" "),t(l.a,{staticClass:"grey--text px-0"},[t(m.a),e._v(" "),t("div",{staticClass:"mx-2"},[e._v("Ou")]),e._v(" "),t(m.a)],1),e._v(" "),e.is_signin?t(f.a,{ref:"is_valid_signin",staticClass:"no-shadow",model:{value:e.is_valid_signin,callback:function(t){e.is_valid_signin=t},expression:"is_valid_signin"}},[t("div",{staticClass:"py-0 px-3 title font-weight-medium"},[e._v("Se connecter")]),e._v(" "),t(v.a,{staticClass:"pa-1 pb-0",attrs:{"no-gutters":""}},[t(d.a,{staticClass:"pa-1",attrs:{cols:"12"}},[t(w.a,{staticClass:"rounded input",attrs:{filled:"",rounded:"",dense:"",name:"phone",label:"Email",rules:[e.$method.rule_required]},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),t(d.a,{staticClass:"pa-1",attrs:{cols:"12"}},[t(w.a,{staticClass:"input",attrs:{filled:"",rounded:"",dense:"",name:"password","append-icon":e.show_password?"mdi-eye":"mdi-eye-off",rules:[e.$method.rule_required,e.$method.rule_min],type:e.show_password?"text":"password",label:"Mot de passe"},on:{"click:append":function(t){e.show_password=!e.show_password}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e._v(" "),t(l.a,{staticClass:"pt-0"},[t(h.a),e._v(" "),t("a",{on:{click:function(t){e.forget_dialog=!0}}},[e._v("Mot de passe oublié?")])],1)],1)],1),e._v(" "),t(l.a,[e.is_signin?t(c.a,{staticClass:"primary rounded shadow",attrs:{block:"",disabled:!e.is_valid_signin,large:"",loading:e.is_loading},on:{click:e.signin}},[e._v("Connexion")]):e._e()],1)],1):t(f.a,{ref:"is_valid_signup",staticClass:"no-shadow",model:{value:e.is_valid_signup,callback:function(t){e.is_valid_signup=t},expression:"is_valid_signup"}},[t("div",{staticClass:"py-0 px-3 title font-weight-medium"},[e._v("Créez votre compte")]),e._v(" "),t(v.a,{staticClass:"pa-1 pb-0",attrs:{"no-gutters":""}},[t(d.a,{staticClass:"pa-1 pb-0",attrs:{cols:"6"}},[t(w.a,{staticClass:"input",attrs:{filled:"",rounded:"",dense:"",name:"first_name",label:"Prénom",rules:[e.$method.rule_required]},model:{value:e.form.first_name,callback:function(t){e.$set(e.form,"first_name",t)},expression:"form.first_name"}})],1),e._v(" "),t(d.a,{staticClass:"pa-1 pb-0",attrs:{cols:"6"}},[t(w.a,{staticClass:"input",attrs:{filled:"",rounded:"",dense:"",name:"last_name",label:"Nom"},model:{value:e.form.last_name,callback:function(t){e.$set(e.form,"last_name",t)},expression:"form.last_name"}})],1),e._v(" "),t(d.a,{staticClass:"pa-1 pt-0 pb-4",attrs:{cols:"12"}},[t("country",{attrs:{get_visitor:!0},on:{change:function(t){e.$set(e.form,"country_id",t.id)}}})],1),e._v(" "),t(d.a,{staticClass:"pa-1 input",attrs:{cols:"12"}},[t(w.a,{attrs:{filled:"",rounded:"",dense:"",name:"email",label:"Email","append-icon":"mdi-email",rules:[e.$method.rule_required,e.$method.rule_email]},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),t(d.a,{staticClass:"pa-1",attrs:{cols:"12"}},[t(w.a,{staticClass:"input",attrs:{filled:"",rounded:"",dense:"",type:"number",name:"phone",label:"Téléphone","append-icon":"mdi-phone",rules:[e.$method.rule_required,e.$method.rule_min]},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),t(d.a,{staticClass:"pa-1",attrs:{cols:"12"}},[t(w.a,{staticClass:"input",attrs:{filled:"",rounded:"",dense:"",name:"password","append-icon":e.show_password?"mdi-eye":"mdi-eye-off",rules:[e.$method.rule_required,e.$method.rule_min],type:e.show_password?"text":"password",label:"Mot de passe"},on:{"click:append":function(t){e.show_password=!e.show_password}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),e._v(" "),t(l.a,[t(c.a,{staticClass:"primary rounded shadow",attrs:{block:"",large:"",disabled:!e.is_valid_signup,loading:e.is_loading},on:{click:e.signup}},[e._v("Enregistrer")])],1)],1),e._v(" "),e.is_signin?t(l.a,{directives:[{def:x.a,name:"ripple",rawName:"v-ripple"}],staticClass:"pa-3 px-3 body-2 cp",on:{click:function(t){e.is_signin=!1}}},[t(h.a),e._v(" "),t("span",{staticClass:"text-center mx-auto black--text body-1 cp blue--text",class:{"grey lighten-5":!e.is_signin},attrs:{text:""}},[e._v("Créer un compte")])],1):t(l.a,{directives:[{def:x.a,name:"ripple",rawName:"v-ripple"}],staticClass:"pa-3 px-3 body-2 cp",on:{click:function(t){e.is_signin=!0}}},[e._v("\n      Vous avez déjà un compte ? "),t(h.a),e._v(" "),t("span",{staticClass:"text-center mx-auto black--text body-1 cp blue--text",class:{"grey lighten-5":e.is_signin},attrs:{text:""}},[e._v("Connexion")])],1)],1),e._v(" "),t(_.a,{attrs:{scrollable:"",persistent:"","max-width":"300px"},model:{value:e.phone_dialog,callback:function(t){e.phone_dialog=t},expression:"phone_dialog"}},[t(r.a,{staticClass:"input back"},[t(l.a,{staticClass:"title pr-2"},[e._v("\n        Téléphone\n        "),t(h.a),e._v(" "),t(o.a,{staticClass:"close",on:{click:function(t){e.phone_dialog=!1}}},[e._v("mdi-close")])],1),e._v(" "),t("div",{staticClass:"pa-2"},[t(w.a,{staticClass:"rounded",attrs:{filled:"",rounded:"","hide-details":"",dense:"",type:"number",name:"phone",prefix:"+216",placeholder:"Ex : 200xxxxx",rules:[e.$method.rule_required]},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}}),e._v(" "),t("div",{staticClass:"caption pa-2 grey--text"},[e._v("\n          Quel est ton numéro de téléphone ?\n        ")])],1),e._v(" "),t(l.a,{staticClass:"pa-2"},[t(h.a),e._v(" "),t(c.a,{staticClass:"shadow",attrs:{color:"success",disabled:!e.form.phone},on:{click:function(t){return e.saveAccount()}}},[e._v("Enregistrer")])],1)],1)],1),e._v(" "),t(_.a,{attrs:{scrollable:"",persistent:"","max-width":"300px"},model:{value:e.forget_dialog,callback:function(t){e.forget_dialog=t},expression:"forget_dialog"}},[t(r.a,{staticClass:"input back",attrs:{disabled:e.is_loading,loading:e.is_loading}},[t(l.a,{staticClass:"title pr-2"},[e._v("\n        Mot de passe oublié\n        "),t(h.a),e._v(" "),t(o.a,{staticClass:"close",on:{click:function(t){e.forget_dialog=!1}}},[e._v("mdi-close")])],1),e._v(" "),e.is_reset_password?e.is_new_password?t("div",[t("div",{staticClass:"pa-2"},[null!==e.reset_password_seconds?t(r.a,{staticClass:"elevation-0 grey lighten-2 pa-2 text-center mb-2 display-1"},[e._v("\n            "+e._s(e.$moment(e.reset_password_seconds).format("mm:ss"))+"\n            "),0==e.reset_password_seconds?t("div",{staticClass:"caption error--text"},[e._v("\n              La date a expiré\n              "),t(l.a,{staticClass:"pa-0 mt-2"},[t(c.a,{staticClass:"elevation-0",attrs:{block:"",color:"white"},on:{click:function(t){e.sendForgetCode(),e.is_new_password=!1}}},[e._v("Renvoyer un nouveau code")])],1)],1):e._e()]):e._e(),e._v(" "),e.reset_password_seconds>0?t("div",[t(w.a,{attrs:{filled:"",rounded:"",dense:"","hide-details":"",name:"password","append-icon":e.show_password?"mdi-eye":"mdi-eye-off",rules:[e.$method.rule_required,e.$method.rule_min],type:e.show_password?"text":"password",label:"Mot de passe"},on:{"click:append":function(t){e.show_password=!e.show_password}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),e._v(" "),t("div",{staticClass:"caption pa-2 grey--text"},[e._v("\n              Quel est votre nouveau mot de passe\n            ")])],1):e._e()],1),e._v(" "),t(l.a,{staticClass:"pa-2"},[t(c.a,{attrs:{color:"error",text:""},on:{click:function(t){e.forget_dialog=!1}}},[e._v("Annuler")]),e._v(" "),t(h.a),e._v(" "),t(c.a,{attrs:{color:"primary",disabled:!e.form.password&&e.reset_password_seconds<1},on:{click:function(t){return e.newPassword()}}},[e._v("Enregistrer")])],1)],1):t("div",[t("div",{staticClass:"pa-2"},[null!==e.reset_password_seconds?t(r.a,{staticClass:"elevation-0 grey lighten-2 pa-2 text-center mb-4 display-1"},[e._v("\n            "+e._s(e.$moment(e.reset_password_seconds).format("mm:ss"))+"\n            "),e.reset_password_seconds<1?t("div",{staticClass:"caption error--text"},[e._v("\n              La date a expiré\n              "),t(l.a,{staticClass:"pa-0 mt-2"},[t(c.a,{staticClass:"elevation-0",attrs:{block:"",color:"white"},on:{click:function(t){return e.sendForgetCode()}}},[e._v("Renvoyer un nouveau code")])],1)],1):e._e()]):e._e(),e._v(" "),e.reset_password_seconds>0?t("div",[t(w.a,{attrs:{filled:"",rounded:"",type:"number",dense:"","hide-details":"",label:"Code",placeholder:"# # # # # # # #","append-icon":"mdi-key",rules:[e.$method.rule_required]},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}}),e._v(" "),t("div",{staticClass:"caption pa-2 grey--text"},[e._v("\n              Nous enverrons un code de validation au "),t("b",[e._v(e._s(e.form.email))])])],1):e._e()],1),e._v(" "),t(l.a,{staticClass:"pa-2"},[t(c.a,{attrs:{color:"error",text:""},on:{click:function(t){e.forget_dialog=!1}}},[e._v("Annuler")]),e._v(" "),t(h.a),e._v(" "),t(c.a,{attrs:{color:"success",disabled:!e.form.code&&e.reset_password_seconds<1},on:{click:function(t){return e.checkCode()}}},[e._v("Verifier")])],1)],1):t("div",[t("div",{staticClass:"pa-2"},[t(w.a,{attrs:{filled:"",rounded:"",dense:"","hide-details":"",name:"email",label:"Email","append-icon":"mdi-email",rules:[e.$method.rule_required,e.$method.rule_email]},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}}),e._v(" "),t("div",{staticClass:"caption pa-2 grey--text"},[e._v("\n            Pour réinitialiser votre mot de passe, saisisser l'adresse e-mail\n            que vous utilisez pour vous connecter à votre compte MonShop\n          ")])],1),e._v(" "),t(l.a,{staticClass:"pa-2"},[t(c.a,{attrs:{color:"error",text:""},on:{click:function(t){e.forget_dialog=!1}}},[e._v("Annuler")]),e._v(" "),t(h.a),e._v(" "),t(c.a,{staticClass:"shadow",attrs:{color:"success",disabled:!e.form.email},on:{click:function(t){return e.sendForgetCode()}}},[e._v("Envoyer")])],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},layout:"empty",head:function(){return{title:"Créer votre compte MonShop",meta:[{hid:"description",name:"description",content:"Accédez à la page de connexion au compte Google. Cliquez sur Créer un compte."}]}},watch:{"$store.state.user.is_auth":function(e){e&&1!=this.$store.state.user.reset_password&&this.$store.state.user.phone&&this.$router.push(this.localePath({name:"shops"}))}},mounted:function(){this.$store.dispatch("user/validation"),this.$store.state.user.is_auth&&this.$router.push(this.localePath({name:"shops"}))}},A=(n(655),Object(R.a)(P,(function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"background-position":"right bottom","background-repeat-x":"no-repeat","min-height":"100vh","background-size":"100% auto","background-color":"#2c0f70"},style:{"background-image":"url("+n(653)+")!important"}},[t("div",{staticClass:"elevation-10 overflow-auto back back_login"},[t(r.a,{staticClass:"transparent elevation-0 pa-4 rounded-lg",staticStyle:{"max-width":"370px"}},[t("div",{staticClass:"pa-0 px-2 rounded-lg"},[t("nuxt-link",{staticClass:"rounded-xl",staticStyle:{width:"100%"},attrs:{to:e.localePath({name:"index"})}},[t("img",{staticClass:"ma-0",attrs:{src:n(654),alt:"",width:"200px"}})])],1),e._v(" "),t("login",{staticClass:"transparent mt-1",attrs:{is_signin_f:!e.$route.query.up}}),e._v(" "),t("div",{staticClass:"text-center mt-3"},[t("nuxt-link",{staticClass:"text-center black--text text-decoration-none body-2",attrs:{to:e.localePath({name:"index"})}},[t(o.a,{staticClass:"mr-2 black--text"},[e._v("mdi-arrow-left")]),e._v("\n          Retournez à la page d'accueil\n        ")],1)],1)],1)],1)])}),[],!1,null,null,null));t.default=A.exports}}]);